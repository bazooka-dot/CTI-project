# HTTP Server (Port 80)
server {
    listen 80;
    listen [::]:80;
    server_name api-server-prod-01 localhost;

    # Log suspicious requests
    access_log /var/log/honeypot/access.log honeypot;
    error_log /var/log/honeypot/error.log;

    # Root directory
    root /var/www/html;
    index index.html index.htm;

    # Catch common attack patterns
    location ~* \.(php|asp|aspx|jsp|cgi)$ {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    # Common admin/management endpoints
    location ~* ^/(admin|administrator|wp-admin|phpmyadmin|cpanel|webmail|roundcube) {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    # API endpoint simulation
    location /api/ {
        add_header Content-Type application/json;
        return 200 '{"status":"ok","message":"API endpoint"}';
    }

    # Default location
    location / {
        try_files $uri $uri/ =404;
    }
}

# HTTPS Server (Port 443)
server {
    listen 443 ssl;
    listen [::]:443 ssl;
    http2 on;
    server_name api-server-prod-01 localhost;

    # SSL Configuration
    ssl_certificate /tmp/ssl/server.crt;
    ssl_certificate_key /tmp/ssl/server.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;

    # Log suspicious requests
    access_log /var/log/honeypot/access.log honeypot;
    error_log /var/log/honeypot/error.log;

    # Root directory
    root /var/www/html;
    index index.html index.htm;

    # Catch common attack patterns
    location ~* \.(php|asp|aspx|jsp|cgi)$ {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    # Common admin/management endpoints
    location ~* ^/(admin|administrator|wp-admin|phpmyadmin|cpanel|webmail|roundcube) {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    # API endpoint simulation
    location /api/ {
        add_header Content-Type application/json;
        return 200 '{"status":"ok","message":"Secure API endpoint"}';
    }

    # Default location
    location / {
        try_files $uri $uri/ =404;
    }
}

# Alternative HTTP port (8080)
server {
    listen 8080;
    listen [::]:8080;
    server_name api-server-prod-01 localhost;

    access_log /var/log/honeypot/access.log honeypot;
    error_log /var/log/honeypot/error.log;

    root /var/www/html;
    index index.html index.htm;

    # Same security rules as port 80
    location ~* \.(php|asp|aspx|jsp|cgi)$ {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    location ~* ^/(admin|administrator|wp-admin|phpmyadmin|cpanel|webmail|roundcube) {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    location /api/ {
        add_header Content-Type application/json;
        return 200 '{"status":"ok","message":"Development API endpoint"}';
    }

    location / {
        try_files $uri $uri/ =404;
    }
}

# Alternative HTTPS port (8443)
server {
    listen 8443 ssl;
    listen [::]:8443 ssl;
    http2 on;
    server_name api-server-prod-01 localhost;

    # SSL Configuration
    ssl_certificate /tmp/ssl/server.crt;
    ssl_certificate_key /tmp/ssl/server.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;

    access_log /var/log/honeypot/access.log honeypot;
    error_log /var/log/honeypot/error.log;

    root /var/www/html;
    index index.html index.htm;

    # Same security rules
    location ~* \.(php|asp|aspx|jsp|cgi)$ {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    location ~* ^/(admin|administrator|wp-admin|phpmyadmin|cpanel|webmail|roundcube) {
        access_log /var/log/honeypot/attacks.log honeypot;
        return 404;
    }

    location /api/ {
        add_header Content-Type application/json;
        return 200 '{"status":"ok","message":"Secure Development API endpoint"}';
    }

    location / {
        try_files $uri $uri/ =404;
    }
}